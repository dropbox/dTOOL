# DashFlow Helm values for Azure production environment

global:
  environment: production
  azureRegion: ${azure_region}

websocketServer:
  enabled: true
  replicaCount: 3
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 2Gi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70

qualityMonitor:
  enabled: true
  replicaCount: 3
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 2Gi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70

prometheusExporter:
  enabled: true
  replicaCount: 2

redis:
  enabled: false
  external:
    enabled: true
    host: ${redis_host}
    port: 6380
    tls: true
    password: ${redis_key}

postgresql:
  enabled: false
  external:
    enabled: true
    host: ${postgres_host}
    port: 5432
    database: dashflow
    sslMode: require

observability:
  prometheus:
    enabled: true
    retention: 30d
  grafana:
    enabled: true
  jaeger:
    enabled: true
    sampling:
      param: 0.1

ingress:
  enabled: true
  className: azure/application-gateway
  annotations:
    kubernetes.io/ingress.class: azure/application-gateway
    appgw.ingress.kubernetes.io/ssl-redirect: "true"

securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000
  readOnlyRootFilesystem: true

podDisruptionBudget:
  enabled: true
  minAvailable: 2

nodeSelector:
  workload: streaming

tolerations:
  - key: workload
    operator: Equal
    value: streaming
    effect: NoSchedule

affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: dashflow
        topologyKey: kubernetes.io/hostname
